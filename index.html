<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Updated: add viewport-fit=cover for iPhone safe areas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0f172a" />
  <title>TEK2day Dash</title>
  <link rel="manifest" href="/manifest.webmanifest">
  <!-- Open Graph / Twitter social preview -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="TEK2day Dashboard">
  <meta property="og:description" content="T2D Dashboard: TradingView, T2D Pulse, CEORater and OpenAI — all in one place.">
  <meta property="og:url" content="https://dash.tek2dayholdings.com/">
  <meta property="og:image" content="https://dash.tek2dayholdings.com/T2D_Dash_Social_Banner.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="TEK2day Dashboard">
  <meta name="twitter:description" content="T2D Dashboard: TradingView, T2D Pulse, CEORater and OpenAI — all in one place.">
  <meta name="twitter:image" content="https://dash.tek2dayholdings.com/T2D_Dash_Social_Banner.png">

  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="icon" href="/favicon.ico">
  <style>
    /* Original styles (unchanged) */
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; background: #0f172a; min-height: 100vh; padding: 40px 20px; color:#e5e7eb;}
    .container { max-width: 1200px; margin: 0 auto; }
    .tabs { display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; justify-content:center;}
    .tab-button { background: #1f2937; color:#fff; border:1px solid #374151; padding:10px 16px; border-radius:10px; cursor:pointer; font-weight:600; }
    .tab-button.active { background:#fff; color:#111827; border-color:#fff;}
    .tab-content { display:none; background:#0b1220; border-radius:12px; }
    .tab-content.active { display:block; }
    .tab-content.tradingview { background: transparent; }
    .tradingview-container { width:100%; height:min(90vh, 900px); background:#0b1220; border-radius:12px; overflow:hidden; box-shadow: 0 8px 30px rgba(0,0,0,0.4); }
    .iframe-container { width:100%; height:800px; }
    iframe { width:100%; height:100%; border:none; }
    #installBanner { position: fixed; right: 16px; bottom: 16px; background:#111827; color:#f9fafb; border:1px solid #374151; padding:12px 16px; border-radius:12px; display:none; box-shadow: 0 10px 30px rgba(0,0,0,0.4); }
    #installBanner button { background:#22c55e; color:#052e16; border:none; padding:8px 12px; border-radius:10px; font-weight:700; cursor:pointer; margin-left:10px; }
    #installBanner small { opacity: .8; }
    #iosTip { position: fixed; left: 50%; transform: translateX(-50%); bottom: 16px; background:#111827; color:#f9fafb; border:1px solid #374151; padding:10px 14px; border-radius:10px; display:none; }
    @media all and (display-mode: standalone) { body { padding: 20px; } }
  
    .tabs { display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; justify-content:center; align-items:center; }
    .tabs .brand { display:flex; align-items:center; gap:10px; margin-right:6px; text-decoration:none; }
    .tabs .brand img { height:28px; width:auto; border-radius:8px; }

    /* === Minimal, non-breaking mobile margins & safe-area padding === */
    :root {
      --t2d-pad: clamp(12px, 4vw, 24px);
      --t2d-gap: clamp(10px, 3.5vw, 18px);
    }

    @media (max-width: 768px) {
      /* Override only horizontal & bottom padding to respect notches */
      body {
        padding-left: calc(var(--t2d-pad) + env(safe-area-inset-left, 0px));
        padding-right: calc(var(--t2d-pad) + env(safe-area-inset-right, 0px));
        padding-bottom: max(var(--t2d-pad), env(safe-area-inset-bottom, 0px));
      }

      /* Keep content centered without extra side padding (body handles it) */
      .container {
        margin-left: auto;
        margin-right: auto;
        max-width: 1200px;
      }

      /* Gentle vertical rhythm between sections without changing display */
      .tab-content { 
        margin-top: var(--t2d-gap);
        margin-bottom: var(--t2d-gap);
      }

      /* Make tab row breathe on narrow screens and respect safe areas */
      .tabs {
        padding-left: calc(var(--t2d-pad) + env(safe-area-inset-left, 0px));
        padding-right: calc(var(--t2d-pad) + env(safe-area-inset-right, 0px));
      }

      /* Images scale safely on very narrow phones */
      img { max-width: 100%; height: auto; }
    }

    @media (max-width: 400px) {
      :root { --t2d-pad: 12px; --t2d-gap: 10px; }
    }
  
    /* Expand CEORater iframe edge-to-edge on small screens so its internal grid hits a cleaner breakpoint */
    @media (max-width: 768px) {
      .edge-to-edge {
        margin-left: calc(-1 * (var(--t2d-pad) + env(safe-area-inset-left, 0px)));
        margin-right: calc(-1 * (var(--t2d-pad) + env(safe-area-inset-right, 0px)));
        width: auto; /* let it naturally fill to viewport edges */
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="tabs">
      <a class="brand" href="https://tek2day.com" aria-label="TEK2day">
        <img src="android-chrome-192x192.png" alt="TEK2day logo" loading="lazy" decoding="async">
      </a>

      <button class="tab-button active" onclick="switchTab(0)">TradingView</button>
      <button class="tab-button" onclick="switchTab(1)">T2D Pulse</button>
      <button class="tab-button" onclick="switchTab(2)">CEORater</button>
      <button class="tab-button" onclick="switchTab(3)">OpenAI</button>
    </div>

    <div class="tab-content tradingview active">
      <div class="tradingview-container">
        <div id="tradingview-widget" style="width:100%;height:100%;"></div>
      </div>
    </div>

    <div class="tab-content">
      <div class="iframe-container">
        <iframe src="https://pulse.tek2dayholdings.com" title="T2D Pulse"></iframe>
      </div>
    </div>

    <div class="tab-content">
      <div class="iframe-container edge-to-edge">
      <iframe src="https://ceorater.com" title="CEORater"></iframe>
      </div>
    </div>


    <div class="tab-content">
      <div class="iframe-container">
        <iframe src="https://openai.com" title="OpenAI" allow="fullscreen; clipboard-read; clipboard-write" referrerpolicy="strict-origin-when-cross-origin"></iframe>
      </div>
    </div>

    <div id="installBanner" aria-label="Install TEK2day Dashboard">
      <span>Install TEK2day Dashboard</span>
      <button id="installBtn">Install TEK2day Dashboard</button>
      <small id="installStatus" style="margin-left:8px;"></small>
    </div>
    <div id="iosTip">On iOS: tap <strong>Share</strong> → <strong>Add to Home Screen</strong>.</div>

    <script id="tvjs" src="https://s3.tradingview.com/tv.js" defer></script>
    <script>
      const TVReady = new Promise((resolve) => {
        function onReady(){ if (window.TradingView && window.TradingView.widget) resolve(); }
        if (window.TradingView && window.TradingView.widget) resolve();
        else {
          const s = document.getElementById('tvjs');
          if (s) s.addEventListener('load', onReady, { once:true });
          const check = setInterval(() => {
            if (window.TradingView && window.TradingView.widget) { clearInterval(check); resolve(); }
          }, 50);
        }
      });

      async function initTradingView() {
        const el = document.getElementById('tradingview-widget');
        if (!el || el.dataset.initialized === '1') return;
        await TVReady;
        el.dataset.initialized = '1';
        new TradingView.widget({
          autosize: true,
          container_id: 'tradingview-widget',
          symbol: 'NASDAQ:AAPL',
          interval: 'D',
          timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
          theme: 'dark',
          style: 1,
          locale: 'en',
          hide_top_toolbar: false,
          hide_side_toolbar: false,
          allow_symbol_change: true,
          details: true,
          studies: ['MAExp@tv-basicstudies', 'RSI@tv-basicstudies', 'MACD@tv-basicstudies']
        });
      }

      function switchTab(index) {
        const tabs = document.querySelectorAll('.tab-content');
        const buttons = document.querySelectorAll('.tab-button');
        tabs.forEach(t => t.classList.remove('active'));
        buttons.forEach(b => b.classList.remove('active'));
        tabs[index].classList.add('active');
        buttons[index].classList.add('active');
        if (tabs[index].classList.contains('tradingview')) initTradingView();
      }

      window.addEventListener('DOMContentLoaded', () => {
        if (document.querySelector('.tab-content.tradingview.active')) initTradingView();
      });

      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js').catch(console.error);
        });
      }

      let deferredPrompt = null;
      const banner = document.getElementById('installBanner');
      const installBtn = document.getElementById('installBtn');
      const status = document.getElementById('installStatus');

      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        banner.style.display = 'block';
      });

      installBtn?.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        status.textContent = outcome === 'accepted' ? 'Installing…' : 'Dismissed';
        deferredPrompt = null;
        banner.style.display = 'none';
      });

      window.addEventListener('appinstalled', () => {
        status.textContent = 'Installed!';
        banner.style.display = 'none';
      });

      const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);
      const isInStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
      if (isIOS && !isInStandalone) {
        const tip = document.getElementById('iosTip');
        tip.style.display = 'block';
        setTimeout(() => tip.style.display = 'none', 8000);
      }
    </script>
  </div>
</body>
</html>
